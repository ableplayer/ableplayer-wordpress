(()=>{jQuery(document).ready(function(t){let p=window.location.hash,b=document.querySelectorAll(".ableplayer-tabs");for(let e=0;e<b.length;e++)t(b[e]).find(p).length!==0?g(p):(p=t(b[e]).find("[role=tablist]").attr("data-default"),g("#"+p));let f=document.querySelectorAll(".ableplayer-tabs [role=tab]");for(let e=0;e<f.length;e++)f[e].addEventListener("click",v),f[e].addEventListener("keydown",w);function v(e){let n=t(e.currentTarget).closest(".tabs").find("[role=tab]"),o=t(e.currentTarget).closest(".ableplayer-tabs"),c=t(e.currentTarget).parents(".inside"),s=e.target.getAttribute("aria-controls"),i=t("iframe.mc-iframe"),l=[];c.length==0&&!o.hasClass("mcs-tabs")?l=o.find(".ui-sortable > [role=tabpanel]"):l=o.find("[role=tabpanel]");for(let r=0;r<n.length;r++)n[r].setAttribute("aria-selected","false");e.target.setAttribute("aria-selected","true");for(let r=0;r<l.length;r++)l[r].setAttribute("aria-hidden","true");c.length==0&&(window.location.hash=s),document.getElementById(s).setAttribute("aria-hidden","false");for(let r=0;r<i.length;r++){let d=i[r];resizeIframe(d)}t("#"+s).attr("tabindex","-1").trigger("focus"),window.scrollTo(0,0)}function g(e){let a=e.replace("#",""),n=t("button[aria-controls="+a+"]"),c=t(e).closest(".tabs").find("[role=tab]"),i=t(e).closest(".ableplayer-tabs").find("[role=tabpanel]"),l=document.getElementById(a);for(let r=0;r<c.length;r++)c[r].setAttribute("aria-selected","false");n.attr("aria-selected","true");for(let r=0;r<i.length;r++)i[r].setAttribute("aria-hidden","true");l!==null&&l.setAttribute("aria-hidden","false")}function w(e){e.keyCode==37&&(t(e.currentTarget).prev().trigger("click").trigger("focus"),e.preventDefault()),e.keyCode==38&&(t(e.currentTarget).prev().trigger("click").trigger("focus"),e.preventDefault()),e.keyCode==39&&(t(e.currentTarget).next().trigger("click").trigger("focus"),e.preventDefault()),e.keyCode==40&&(t(e.currentTarget).next().trigger("click").trigger("focus"),e.preventDefault())}new ClipboardJS(".ableplayer-copy-to-clipboard").on("success",function(e){let n=e.trigger.parentNode.querySelector(".ableplayer-notice-copied"),o=n.textContent;wp.a11y.speak(o),n.classList.add("visible")}),t(".media-sources").hide();let h=t("#source_type").val();t(".media-sources."+h).show(),t(".media-sources."+h).find("input").attr("required","true"),t("#source_type").on("change",function(e){let a=t(this).val();t(".media-sources").hide(),t(".media-sources").find("input").removeAttr("required"),t(".media-sources."+a).show(),t(".media-sources."+a).find("input").attr("required","true")});var u="";function k(){typeof u!="string"&&(u.detach(),u="")}t(".ableplayer-remove-preview").on("click",function(e){let a=t(this).data("input"),n=t(this).parent().parent(".ableplayer-media-preview");t("#"+a).val(""),t(".preview-"+a+" > *").remove(),n.removeClass("has-value"),wp.a11y.speak(ableplayer.removed)}),t(".upload-ableplayer-media").on("click",function(e){let a=t(this).data("input"),n=document.querySelector('input[name="'+a+'"]'),o=document.querySelector(".preview-"+a),c=t(this).parent().parent(".ableplayer-media-preview");console.log(c);let s;a==="media-id"?s=["audio","video"]:a==="poster"?s=["image"]:s=["text/vtt"],k(),u=wp.media({multiple:!1,title:ableplayer[a+"Title"],library:{type:s},button:{text:ableplayer.buttonName}}),u.on("select",function(){let i=u.state().get("selection"),l="",r="",d="",m="",y="";i&&(l=i.first().attributes.id,a==="poster"?(d=ableplayer.thumbHeight,m=Math.round(i.first().attributes.width/i.first().attributes.height*d),y=i.first().attributes.alt,r="<img id='event_image' src='"+i.first().attributes.url+"' width='"+m+"' height='"+d+"' alt='"+y+"' />",n.value=l,o.innerHTML=r):(o.innerHTML="<pre>"+i.first().attributes.url.replace(ableplayer.homeUrl,"")+"</pre>",n.value=l),c.addClass("has-value"))}),u.open()})});})();
